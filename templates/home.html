<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office of Academics at Jain (Deemed-to-be University)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        /* Chart container styling */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* Dashboard styling */
        .dashboard-section {
            padding: 3rem 0;
            background-color: #f8f9fa;
        }
        
        .dashboard-section h1 {
            text-align: center;
            margin-bottom: 2rem;
            color: #2c3e50;
        }
        
        .dashboard-section h2 {
            margin-bottom: 1.5rem;
            color: #34495e;
            font-size: 1.5rem;
        }
        
        .dashboard-section h3 {
            margin-bottom: 1rem;
            color: #4e73df;
            font-size: 1.2rem;
        }
        
        .tab-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .tab-buttons button {
            padding: 12px 25px;
            background-color: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s ease;
        }
        
        .tab-buttons button.active {
            background-color: #4e73df;
            color: white;
            box-shadow: 0 4px 8px rgba(78, 115, 223, 0.3);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }
        
        .dashboard-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.12);
        }
        
        .dashboard-card.full-width {
            grid-column: 1 / -1;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            margin-bottom: 15px;
        }
        
        .chart-summary {
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.5;
            color: #495057;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .section.active-tab {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Newsletter grid styling */
        .newsletter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .newsletter-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .newsletter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .newsletter-card-image {
            height: 180px;
            overflow: hidden;
        }

        .newsletter-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .newsletter-card-content {
            padding: 15px;
        }

        .newsletter-card-title {
            margin: 0 0 10px 0;
            color: #333;
        }

        .newsletter-card-excerpt {
            color: #666;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .newsletter-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #888;
        }

        .newsletter-card-readmore {
            color: #4e73df;
            font-weight: bold;
        }

        /* Other existing styles remain the same */
    </style>
</head>
<body>
    <!-- Animated Background Elements -->
    <div class="bg-animation">
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
    </div>

    <!-- Accessibility Bar -->
    <div class="accessibility-bar">
        <div class="accessibility-container">
            <button id="textSizeToggle"><i class="fas fa-text-height"></i> Text Size: A A A</button>
            <a href="#newsletter"><i class="fas fa-skip-forward"></i> Skip to Newsletter</a>
            <a href="#main-content"><i class="fas fa-skip-forward"></i> Skip to Main Content</a>
        </div>
    </div>

    <header>
        <div class="header-container">
            <div class="logo-section">
                <img src="{{ url_for('static', filename='images/jain.png') }}" onerror="this.src='https://via.placeholder.com/60?text=JU+Logo';" alt="Jain University Logo">
                <div class="logo-text">
                    <h1>Office of Academics</h1>
                    <span>Excellence in Education</span>
                </div>
            </div>
            
            <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
                <i class="fas fa-bars"></i>
            </button>
          
            <nav class="nav-links">
                <a href="#">Home</a>
                <a href="{{ url_for('usernewsletters') }}">Newsletters</a>
                <a href="{{ url_for('ugc') }}">UGC Requirement</a>
                <a href="{{ url_for('monthlyengagement') }}">Engagement</a>
                <a href="{{ url_for('jainevents') }}">Events</a>
                <a href="{{ url_for('login') }}" class="login-btn"><i class="fas fa-sign-in-alt"></i> Login</a>
            </nav>
        </div>
    </header>

    <!-- University Updates Marquee -->
    <div class="university-updates" aria-live="polite">
        <div class="updates-container">
            <div class="updates-label">
                <i class="fas fa-bullhorn"></i> University Updates
            </div>
            <div class="updates-marquee">
                <p>
                    {% for item in records if 'University Notice' in item.categories %}
                        {% if loop.index <= 10 %}
                            <a href="#">{{ item.text_data }}</a> â€¢
                        {% endif %}
                    {% endfor %}
                    <a href="{{ url_for('ugc') }}">View all updates</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Content Anchor -->
    <a id="main-content" class="skip-anchor"></a>

    <!-- Main Content Container -->
    <main class="main-container">
        <!-- Notices Section with Newsletter -->
        <div class="notices-container">
            <!-- UGC Notices Section -->
            <div class="notice-section ugc-notice-section">
                <div class="card-header">
                    <i class="fas fa-bullhorn"></i> UGC Notices & Announcements
                </div>
                <div class="scrolling-content">
                    <div class="scrolling-wrapper">
                        {% for item in records if 'UGC' in item.categories %}
                            <div class="ugc-notice">
                                <p><i class="fas fa-calendar-alt"></i> Published on:
                                    {{ item.uploaded_at.strftime('%d/%m/%Y') if item.uploaded_at.__class__.__name__ == 'datetime' else item.uploaded_at }}
                                </p>
                                <p><i class="fas fa-file-alt"></i> {{ item.text_data }}</p>
                                {% if item.files %}
                                    <ul class="file-list">
                                        {% for file in item.files %}
                                            <li>
                                                <i class="fas fa-file-pdf"></i>
                                                <a href="#" onclick="openPdfModal('{{ url_for('uploaded_file', filename=file) }}')">{{ file }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="read-more">
                    <a href="{{ url_for('ugc') }}"><i class="fas fa-eye"></i> View All UGC Notices</a>
                </div>
            </div>

            <!-- University Notices Section -->
            <div class="notice-section university-notice-section">
                <div class="card-header">
                    <i class="fas fa-university"></i> University Notices
                </div>
                <div class="scrolling-content">
                    <div class="scrolling-wrapper">
                        {% for item in records if 'University Notice' in item.categories %}
                            <div class="ugc-notice">
                                <p><i class="fas fa-calendar-alt"></i> Published on:
                                    {{ item.uploaded_at.strftime('%d/%m/%Y') if item.uploaded_at.__class__.__name__ == 'datetime' else item.uploaded_at }}
                                </p>
                                <p><i class="fas fa-file-alt"></i> {{ item.text_data }}</p>
                                {% if item.files %}
                                    <ul class="file-list">
                                        {% for file in item.files %}
                                            <li>
                                                <i class="fas fa-file-pdf"></i>
                                                <a href="#" onclick="openPdfModal('{{ url_for('uploaded_file', filename=file) }}')">{{ file }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="read-more">
                    <a href="{{ url_for('ugc') }}"><i class="fas fa-eye"></i> View All University Notices</a>
                </div>
            </div>

            <!-- Newsletter Section -->
            <div class="newsletter-section" id="newsletter">
                <div class="newsletter-header">
                    <i class="fas fa-newspaper"></i> Latest Newsletters
                </div>
                <div class="newsletter-scrolling-content">
                    <div class="newsletter-scrolling-wrapper">
                        {% if newsletter_records %}
                            {% for news in newsletter_records %}
                                <div class="newsletter-item" onclick="openNewsletterModal('{{ news.title }}', '{{ news.description }}', '{{ news.image }}', '{{ news.uploaded_at.strftime('%d %B %Y') if news.uploaded_at.__class__.__name__ == 'datetime' else news.uploaded_at }}', '{{ news.tags|join(",") if news.tags else "" }}')">
                                    {% if news.image %}
                                    <div class="newsletter-image">
                                        <img src="{{ url_for('static', filename='uploads/' ~ news.image) }}" alt="{{ news.title }}" loading="lazy">
                                    </div>
                                    {% else %}
                                    <div class="newsletter-image">
                                        <img src="https://via.placeholder.com/80?text=Newsletter" alt="Default Newsletter Image" loading="lazy">
                                    </div>
                                    {% endif %}
                                    <div class="newsletter-content">
                                        <div class="newsletter-title">{{ news.title }}</div>
                                        <div class="newsletter-date"><i class="far fa-calendar-alt"></i> {{ news.uploaded_at.strftime('%d %b %Y') if news.uploaded_at.__class__.__name__ == 'datetime' else news.uploaded_at }}</div>
                                        {% if news.tags %}
                                        <div class="newsletter-tags">
                                            {% for tag in news.tags[:2] %}
                                                <span class="newsletter-tag">{{ tag }}</span>
                                            {% endfor %}
                                            {% if news.tags|length > 2 %}
                                                <span class="newsletter-tag">+{{ news.tags|length - 2 }} more</span>
                                            {% endif %}
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="newsletter-item">
                                <div class="newsletter-content">
                                    <div class="newsletter-title">No newsletters available</div>
                                    <div class="newsletter-date">Check back later for updates</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="read-more">
                    <a href="{{ url_for('usernewsletters') }}"><i class="fas fa-eye"></i> View All Newsletters</a>
                </div>
            </div>
        </div>

        <!-- Newsletter Grid View Section -->
        <div class="section-title" style="margin-top: 60px;">
            <h2>Featured Newsletters</h2>
        </div>
        
        <div class="newsletter-grid">
            {% if newsletter_records %}
                {% for news in newsletter_records[:6] %}
                    <div class="newsletter-card" onclick="openNewsletterModal('{{ news.title }}', '{{ news.description }}', '{{ news.image }}', '{{ news.uploaded_at.strftime('%d %B %Y') if news.uploaded_at.__class__.__name__ == 'datetime' else news.uploaded_at }}', '{{ news.tags|join(",") if news.tags else "" }}')">
                        <div class="newsletter-card-image">
                            {% if news.image %}
                                <img src="{{ url_for('static', filename='uploads/' ~ news.image) }}" alt="{{ news.title }}">
                            {% else %}
                                <img src="https://via.placeholder.com/300x180?text=Newsletter" alt="Default Newsletter Image">
                            {% endif %}
                        </div>
                        <div class="newsletter-card-content">
                            <h3 class="newsletter-card-title">{{ news.title }}</h3>
                            <div class="newsletter-card-excerpt">
                                {{ news.description|striptags|truncate(120) }}
                            </div>
                            <div class="newsletter-card-meta">
                                <span class="newsletter-card-date"><i class="far fa-calendar-alt"></i> {{ news.uploaded_at.strftime('%d %b %Y') if news.uploaded_at.__class__.__name__ == 'datetime' else news.uploaded_at }}</span>
                                <span class="newsletter-card-readmore">Read More <i class="fas fa-arrow-right"></i></span>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="newsletter-card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                    <h3>No newsletters available at this time</h3>
                    <p>Check back later for our latest academic newsletters</p>
                </div>
            {% endif %}
        </div>
        
        <div style="text-align: center; margin: 40px 0;">
            <a href="{{ url_for('usernewsletters') }}" class="hero-btn" style="background-color: var(--jain-purple); border-color: var(--jain-purple);">
                <i class="fas fa-newspaper"></i> Browse All Newsletters
            </a>
        </div>

        <!-- University Engagement Dashboard -->
        <div class="dashboard-section">
            <div class="container">
                <h1>University Engagement Dashboard</h1>

                <!-- Tab Buttons -->
                <div class="tab-buttons">
                    <button class="active" onclick="openTab('students')">Students Engagement</button>
                    <button onclick="openTab('faculty')">Faculty Engagement</button>
                    <button onclick="openTab('learning')">Learning Analytics</button>
                </div>

                <!-- Students Tab -->
                <div id="students" class="section" style="display:block;">
                    <h2>Students Activation and Engagement</h2>
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <h3>JGI Bengaluru</h3>
                            <div class="chart-container">
                                <canvas id="studentsChartBlr"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Students: 19,716<br>
                                87% engaged | 11.31% incomplete | 1.69% not enrolled
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>JGI Kochi</h3>
                            <div class="chart-container">
                                <canvas id="studentsChartKochi"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Students: 725<br>
                                78.21% engaged | 20.06% incomplete | 5.66% not enrolled
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>ARKA JAIN</h3>
                            <div class="chart-container">
                                <canvas id="studentsChartArka"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Students: 4,190<br>
                                88% engaged | 8.14% incomplete | 4% not enrolled
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Faculty Tab -->
                <div id="faculty" class="section">
                    <h2>Faculty Members Activation and Engagement</h2>
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <h3>JGI Bengaluru</h3>
                            <div class="chart-container">
                                <canvas id="facultyChartBlr"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Faculty: 847<br>
                                49.2% completed | 48.9% incomplete | 1.9% not enrolled
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>JGI Kochi</h3>
                            <div class="chart-container">
                                <canvas id="facultyChartKochi"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Faculty: 79<br>
                                57% completed | 38% incomplete | 5.1% not enrolled
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3>ARKA JAIN</h3>
                            <div class="chart-container">
                                <canvas id="facultyChartArka"></canvas>
                            </div>
                            <div class="chart-summary">
                                Total Faculty: 186<br>
                                54.8% completed | 43.5% incomplete | 1.6% not enrolled
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Learning Tab -->
                <div id="learning" class="section">
                    <h2>Learning Hours Trend</h2>
                    <div class="dashboard-card full-width">
                        <div class="chart-container" style="height: 400px;">
                            <canvas id="learningChart"></canvas>
                        </div>
                        <div class="chart-summary">
                            Learner engagement peaked in Nov 2024 with 47,944 total hours. Standalone courses were most accessed. 
                            Activity dropped in May 2025 due to exams/vacation.
                        </div>
                    </div>
                    
                    <h2 style="margin-top: 40px;">Monthly Completions</h2>
                    <div class="dashboard-card full-width">
                        <div class="chart-container" style="height: 400px;">
                            <canvas id="completionsChart"></canvas>
                        </div>
                        <div class="chart-summary">
                            March 2025 had the highest completions (29,842). Declines in April & May linked to exams and reduced activity.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monthly Engagement Section -->
        <div class="engagement-section">
            <div class="container">
                <div class="engagement-title">
                    <h2>Academic Engagements & Events</h2>
                    <p>Discover our monthly academic activities, workshops, and events that shape the future of education</p>
                </div>
                
                <div class="engagement-grid">
                    {% if monthly_records %}
                        {% for record in monthly_records %}
                            <div class="engagement-card">
                                <div class="engagement-card-header">
                                    {{ record.heading }}
                                </div>
                                <div class="engagement-card-body">
                                    <p>{{ record.description }}</p>
                                    
                                    <div class="engagement-meta">
                                        <span><i class="fas fa-university"></i> {{ record.school }}</span>
                                        <span><i class="fas fa-building"></i> {{ record.department }}</span>
                                    </div>
                                    
                                    {% if record.tags %}
                                    <div class="engagement-tags">
                                        {% for tag in record.tags %}
                                            <span class="engagement-tag">{{ tag }}</span>
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if record.files %}
                                        {% for file in record.files %}
                                            {% if file.endswith('.pdf') %}
                                                <div class="engagement-media">
                                                    <div class="pdf-preview">
                                                        <i class="fas fa-file-pdf"></i>
                                                        <span>PDF Document</span>
                                                    </div>
                                                    <div class="engagement-media-overlay">
                                                        <a href="{{ url_for('static', filename='uploads/' ~ file) }}" target="_blank" class="media-view-btn">View PDF</a>
                                                    </div>
                                                </div>
                                            {% elif file.endswith('.jpg') or file.endswith('.png') or file.endswith('.jpeg') %}
                                                <div class="engagement-media">
                                                    <img src="{{ url_for('static', filename='uploads/' ~ file) }}" alt="Event Image">
                                                    <div class="engagement-media-overlay">
                                                        <a href="{{ url_for('static', filename='uploads/' ~ file) }}" target="_blank" class="media-view-btn">View Image</a>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="engagement-card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                            <h3>No engagement records available at this time</h3>
                            <p>Check back later for upcoming academic events and activities</p>
                        </div>
                    {% endif %}
                </div>
                
                <div style="text-align: center; margin-top: 50px;">
                    <a href="{{ url_for('monthlyengagement') }}" class="hero-btn" style="background-color: var(--jain-blue); border-color: var(--jain-blue);">
                        <i class="fas fa-calendar-check"></i> View All Engagements
                    </a>
                </div>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="stats-section">
            <div class="stats-container">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number">30+</div>
                        <div class="stat-label">Years of Excellence</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">150+</div>
                        <div class="stat-label">Programs Offered</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">500+</div>
                        <div class="stat-label">Faculty Members</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">40,000+</div>
                        <div class="stat-label">Students Enrolled</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-wave"></div>
        <div class="footer-container">
            <div class="footer-column">
                <h3> Office of Academics</h3>
                <p>Empowering innovation through education, research, and holistic development.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Quick Links</h3>
                <ul>
                    <li><i class="fas fa-chevron-right"></i><a href="#">Home</a></li>
                    <li><i class="fas fa-chevron-right"></i><a href="{{ url_for('about') }}">About Us</a></li>
                    <li><i class="fas fa-chevron-right"></i><a href="{{ url_for('ugc') }}">UGC Requirement</a></li>
                    <li><i class="fas fa-chevron-right"></i><a href="{{ url_for('monthlyengagement') }}">Monthly Engagement</a></li>
                    <li><i class="fas fa-chevron-right"></i><a href="{{ url_for('contact') }}">Contact Us</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>Contact Info</h3>
                <ul>
                    <li><i class="fas fa-map-marker-alt"></i><a href="#"> Bangalore - 560069</a></li>
                    <li><i class="fas fa-phone-alt"></i><a href="tel:+918023456789">+91 80 2345 6789</a></li>
                    <li><i class="fas fa-envelope"></i><a href="mailto:info@jainuniversity.ac.in">info@jainuniversity.ac.in</a></li>
                    <li><i class="fas fa-clock"></i> Mon-Fri: 9:00 AM - 5:00 PM</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 Office of Academics. All Rights Reserved.
        </div>
    </footer>

    <!-- PDF Modal -->
    <div id="pdfModal" class="pdf-modal">
        <div class="pdf-modal-content">
            <span class="close-modal" onclick="closePdfModal()">&times;</span>
            <iframe id="pdfIframe" class="pdf-iframe" frameborder="0"></iframe>
        </div>
    </div>

    <!-- Newsletter Modal -->
    <div id="newsletterModal" class="newsletter-modal">
        <div class="newsletter-modal-content">
            <div class="newsletter-modal-header">
                <h3 id="modalNewsletterTitle"></h3>
                <span class="newsletter-modal-close" onclick="closeNewsletterModal()">&times;</span>
            </div>
            <div class="newsletter-modal-body">
                <div class="newsletter-modal-image">
                    <img id="modalImageSrc" src="" alt="Newsletter Image" style="display: none;">
                </div>
                <div id="modalNewsletterDescription" class="newsletter-modal-description"></div>
            </div>
            <div class="newsletter-modal-footer">
                <div class="newsletter-modal-tags" id="modalNewsletterTags"></div>
                <div class="newsletter-modal-date" id="modalNewsletterDate"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all charts
            initStudentsCharts();
            initFacultyCharts();
            initLearningChart();
            initCompletionsChart();
            
            // Activate first tab by default
            openTab('students');
            
            // Setup other functionality
            setupMobileNavigation();
            setupTextSizeToggle();
            setupTextToSpeech();
            setupScrollEffects();
        });

        // Tab switching function
        function openTab(tabId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-buttons button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected section and activate button
            document.getElementById(tabId).style.display = 'block';
            event.target.classList.add('active');
        }

        // STUDENTS CHARTS - Now shows percentages and counts always visible
        function initStudentsCharts() {
            // Bangalore Students Chart
            const ctxBlr = document.getElementById('studentsChartBlr').getContext('2d');
            new Chart(ctxBlr, {
                type: 'bar',
                data: {
                    labels: ['Engaged', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Students',
                        data: [17152, 2230, 334],
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Students Distribution - Bangalore',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Kochi Students Chart
            const ctxKochi = document.getElementById('studentsChartKochi').getContext('2d');
            new Chart(ctxKochi, {
                type: 'bar',
                data: {
                    labels: ['Engaged', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Students',
                        data: [567, 117, 41],
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Students Distribution - Kochi',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Arka Students Chart
            const ctxArka = document.getElementById('studentsChartArka').getContext('2d');
            new Chart(ctxArka, {
                type: 'bar',
                data: {
                    labels: ['Engaged', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Students',
                        data: [3686, 341, 163],
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Students Distribution - ARKA',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // FACULTY CHARTS - Now shows percentages and counts always visible
        function initFacultyCharts() {
            // Bangalore Faculty Chart
            const ctxBlr = document.getElementById('facultyChartBlr').getContext('2d');
            new Chart(ctxBlr, {
                type: 'bar',
                data: {
                    labels: ['Completed', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Faculty',
                        data: [417, 414, 13],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Faculty Distribution - Bangalore',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Kochi Faculty Chart
            const ctxKochi = document.getElementById('facultyChartKochi').getContext('2d');
            new Chart(ctxKochi, {
                type: 'bar',
                data: {
                    labels: ['Completed', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Faculty',
                        data: [45, 30, 4],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Faculty Distribution - Kochi',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Arka Faculty Chart
            const ctxArka = document.getElementById('facultyChartArka').getContext('2d');
            new Chart(ctxArka, {
                type: 'bar',
                data: {
                    labels: ['Completed', 'Incomplete', 'Not Enrolled'],
                    datasets: [{
                        label: 'Faculty',
                        data: [102, 81, 3],
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 159, 64, 0.7)',
                            'rgba(255, 99, 132, 0.7)'
                        ],
                        borderColor: [
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(255, 99, 132, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Faculty Distribution - ARKA',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value, context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%\n(${value.toLocaleString()})`;
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // LEARNING HOURS CHART
        function initLearningChart() {
            const ctx = document.getElementById('learningChart').getContext('2d');
            window.learningChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['May 2025','Apr 2025','Mar 2025','Feb 2025','Jan 2025','Dec 2024','Nov 2024','Oct 2024','Sep 2024','Aug 2024','Jul 2024'],
                    datasets: [
                        { 
                            type: 'bar', 
                            label: 'Standalone Courses', 
                            data: [14708,31130,40366,31346,23896,26433,47504,43910,28160,17861,1750], 
                            backgroundColor: '#4682B4' 
                        },
                        { 
                            type: 'line', 
                            label: 'Total Learning Hours', 
                            data: [14856,31300,40727,31597,24127,26616,47944,44287,28566,18258,1768], 
                            borderColor: '#FFA500', 
                            backgroundColor: '#FFA500', 
                            fill: false 
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { 
                        mode: 'index', 
                        intersect: false 
                    },
                    plugins: { 
                        legend: { 
                            position: 'top', 
                            labels: { 
                                color: 'black' 
                            } 
                        }, 
                        datalabels: {
                            display: true,
                            anchor: 'end',
                            align: 'top',
                            color: 'black',
                            font: {
                                weight: 'bold'
                            },
                            formatter: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        title: {
                            display: true,
                            text: 'Monthly Learning Hours Trend',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: { 
                        x: { 
                            ticks: { 
                                color: 'black' 
                            } 
                        }, 
                        y: { 
                            beginAtZero: true, 
                            ticks: { 
                                color: 'black',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            } 
                        } 
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // MONTHLY COMPLETIONS CHART
        function initCompletionsChart() {
            const ctx = document.getElementById('completionsChart').getContext('2d');
            window.completionsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['May','Apr','Mar','Feb','Jan','Dec','Nov','Oct','Sep','Aug','Jul'],
                    datasets: [
                        { 
                            label: 'Completions', 
                            data: [6294,15703,29842,17695,10697,13704,24266,14780,11660,5453,0], 
                            backgroundColor: '#4682B4' 
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            display: false 
                        }, 
                        datalabels: { 
                            anchor: 'end', 
                            align: 'end', 
                            color: 'black', 
                            font: { 
                                weight: 'bold',
                                size: 12
                            },
                            formatter: function(value) {
                                return value.toLocaleString();
                            }
                        },
                        title: {
                            display: true,
                            text: 'Monthly Course Completions',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: { 
                        x: { 
                            ticks: { 
                                color: 'black' 
                            } 
                        }, 
                        y: { 
                            ticks: { 
                                color: 'black',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            } 
                        } 
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function setupMobileNavigation() {
            const toggle = document.querySelector(".nav-toggle");
            const navLinks = document.querySelector(".nav-links");

            toggle.addEventListener("click", () => {
                const expanded = toggle.getAttribute('aria-expanded') === 'true';
                toggle.setAttribute('aria-expanded', !expanded);
                navLinks.classList.toggle("show");
            });
        }

        function setupTextSizeToggle() {
            const textSizeToggle = document.getElementById('textSizeToggle');
            if (textSizeToggle) {
                textSizeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    const html = document.documentElement;
                    const currentSize = parseFloat(window.getComputedStyle(html, null).getPropertyValue('font-size'));
                    
                    // Toggle between different font sizes
                    if (currentSize === 16) {
                        html.style.fontSize = '18px';
                    } else if (currentSize === 18) {
                        html.style.fontSize = '20px';
                    } else {
                        html.style.fontSize = '16px';
                    }
                });
            }
        }

        function setupTextToSpeech() {
            const speakButton = document.getElementById('speakContent');
            if (speakButton && 'speechSynthesis' in window) {
                speakButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    const mainContent = document.querySelector('main').textContent || document.body.textContent;
                    const speech = new SpeechSynthesisUtterance();
                    speech.text = mainContent;
                    speech.volume = 1;
                    speech.rate = 1;
                    speech.pitch = 1;
                    window.speechSynthesis.speak(speech);
                });
            }
        }

        function setupScrollEffects() {
            // Header scroll effect
            window.addEventListener('scroll', function() {
                const header = document.querySelector('header');
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            // Add animation to elements when they come into view
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            // Apply to newsletter cards
            document.querySelectorAll('.newsletter-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(card);
            });

            // Apply to engagement cards
            document.querySelectorAll('.engagement-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(card);
            });
        }

        // PDF Modal functionality
        function openPdfModal(pdfUrl) {
            const modal = document.getElementById('pdfModal');
            const iframe = document.getElementById('pdfIframe');
            iframe.src = pdfUrl;
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePdfModal() {
            const modal = document.getElementById('pdfModal');
            const iframe = document.getElementById('pdfIframe');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
            setTimeout(() => {
                iframe.src = '';
            }, 300);
        }

        // Newsletter Modal functionality
        function openNewsletterModal(title, description, image, date, tags) {
            const modal = document.getElementById('newsletterModal');
            document.getElementById('modalNewsletterTitle').textContent = title;
            document.getElementById('modalNewsletterDescription').innerHTML = description;
            document.getElementById('modalNewsletterDate').innerHTML = `<i class="far fa-calendar-alt"></i> Published on: ${date}`;
            
            // Set image
            const imageElement = document.getElementById('modalImageSrc');
            if (image) {
                imageElement.src = "{{ url_for('static', filename='uploads/') }}" + image;
                imageElement.style.display = 'block';
            } else {
                imageElement.style.display = 'none';
            }
            
            // Set tags
            const tagsContainer = document.getElementById('modalNewsletterTags');
            tagsContainer.innerHTML = '';
            if (tags) {
                const tagsArray = tags.split(',');
                tagsArray.forEach(tag => {
                    if (tag.trim()) {
                        const tagElement = document.createElement('span');
                        tagElement.className = 'newsletter-tag';
                        tagElement.textContent = tag.trim();
                        tagsContainer.appendChild(tagElement);
                    }
                });
            }
            
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeNewsletterModal() {
            const modal = document.getElementById('newsletterModal');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const pdfModal = document.getElementById('pdfModal');
            const newsletterModal = document.getElementById('newsletterModal');
            
            if (event.target == pdfModal) {
                closePdfModal();
            }
            
            if (event.target == newsletterModal) {
                closeNewsletterModal();
            }
        }
    </script>
</body>
</html>