<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>University Newsletters</title>
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
  
  <!-- Google Fonts: Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    :root {
      --jain-blue: #003366;
      --jain-gold: #FFD700;
      --jain-light: #f5f5f5;
      --jain-dark: #222;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--jain-light);
    }
    
    /* Header styles */
    header {
      background: white;
      padding: 15px 30px;
      box-shadow: 0 2px 15px rgba(0, 51, 102, 0.15);
      position: sticky;
      top: 0;
      z-index: 10000;
      border-radius: 0 0 30px 30px;
    }
    
    .header-container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    
    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
    }
    
    .logo-section img {
      height: 60px;
      width: auto;
      border-radius: 15px;
    }
    
    .logo-text h1 {
      margin: 0;
      font-weight: 700;
      font-size: 1.4rem;
      color: var(--jain-blue);
    }
    
    .logo-text span {
      font-weight: 300;
      font-size: 0.9rem;
      color: #666;
    }
    
    nav {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    nav a {
      padding: 10px 20px;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 30px;
      color: var(--jain-blue);
      transition: all 0.3s ease;
    }
    
    nav a:hover {
      background: var(--jain-gold);
      color: var(--jain-blue);
      box-shadow: 0 0 15px var(--jain-gold);
    }
    
    nav a.active {
      background: var(--jain-gold);
      color: var(--jain-blue);
      box-shadow: 0 0 20px var(--jain-gold);
    }
    
    .login-btn {
      padding: 10px 25px;
      background-color: var(--jain-blue);
      color: white;
      border-radius: 30px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 6px 15px rgba(0, 51, 102, 0.35);
      transition: all 0.3s ease;
    }
    
    .login-btn:hover {
      background-color: var(--jain-gold);
      color: var(--jain-blue);
      box-shadow: 0 8px 20px rgba(255, 215, 0, 0.6);
    }
    
    /* View toggle buttons */
    .view-toggle {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 20px;
    }
    
    .view-toggle button {
      background: white;
      border: none;
      padding: 8px 15px;
      margin-left: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .view-toggle button.active {
      background: var(--jain-blue);
      color: white;
    }
    
    /* Grid view */
    .newsletters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    /* List view */
    .newsletters-list .newsletter-item {
      display: flex;
      margin-bottom: 20px;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .newsletters-list .newsletter-image {
      width: 200px;
      height: 150px;
      object-fit: cover;
    }
    
    .newsletters-list .newsletter-content {
      padding: 15px;
      flex: 1;
    }
    
    /* Newsletters container */
    .newsletters-container {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
    }
    
    /* Subscribe button in header */
    .header-subscribe {
      background: var(--jain-gold);
      color: var(--jain-blue);
      font-weight: 600;
      padding: 8px 20px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    .header-subscribe:hover {
      box-shadow: 0 0 15px var(--jain-gold);
    }
  </style>
</head>
<body>
  <!-- Header with Navigation -->
  <header id="mainHeader">
    <div class="header-container">
      <div class="logo-section" role="banner" tabindex="0">
        <img
          src="{{ url_for('static', filename='images/jain.png') }}"
          alt="Jain University Logo"
          onerror="this.src='https://via.placeholder.com/60?text=JU+Logo';"
          aria-hidden="true"
        />
        <div class="logo-text">
          <h1>Office of Academics</h1>
          <span>Excellence in Education</span>
        </div>
      </div>

      <nav id="primary-navigation" role="navigation" aria-label="Primary navigation">
        <a href="{{ url_for('home') }}" tabindex="0">Home</a>
        <a href="{{ url_for('about') }}" tabindex="0">About Us</a>
        <a href="{{ url_for('ugc') }}" tabindex="0">UGC Requirement</a>
        <a href="{{ url_for('monthlyengagement') }}" class="active" tabindex="0">Monthly Engagement</a>
        <a href="{{ url_for('contact') }}" tabindex="0">Contact Us</a>
        <a href="{{ url_for('login') }}" class="login-btn" tabindex="0" aria-label="Login">
          <i class="fas fa-sign-in-alt" aria-hidden="true"></i> Login
        </a>
        <a href="{{ url_for('subscribe_newsletter') }}" class="header-subscribe" tabindex="0">
          <i class="fas fa-envelope"></i> Subscribe
        </a>
      </nav>
    </div>
  </header>

  <div class="newsletters-container">
    <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">University Newsletters</h1>

    <!-- View Toggle -->
    <div class="view-toggle">
      <button id="listViewBtn" class="active"><i class="fas fa-list"></i> List View</button>
      <button id="gridViewBtn"><i class="fas fa-th-large"></i> Grid View</button>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4 space-y-2">
          {% for category, message in messages %}
            <div class="p-4 rounded text-white 
                        {% if category == 'success' %} bg-green-500 
                        {% elif category == 'error' %} bg-red-500 
                        {% elif category == 'warning' %} bg-yellow-500 
                        {% else %} bg-blue-500 {% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- Newsletter List (Default View) -->
    <div id="newslettersList" class="newsletters-list">
      {% for article in records %}
        <div class="newsletter-item">
          {% if article.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ article.image) }}"
                 class="newsletter-image" alt="{{ article.title }}">
          {% endif %}
          <div class="newsletter-content">
            <h2 class="text-xl font-semibold text-gray-800">{{ article.title }}</h2>
            <p class="text-sm text-gray-500 mb-2">
              {{ article.uploaded_at.strftime('%d %B %Y') }}
            </p>
            <div class="prose max-w-none text-gray-800 mb-3">
              {% autoescape false %}{{ article.description|truncate(200) }}{% endautoescape %}
            </div>
            <div class="mt-2">
              {% for tag in article.tags %}
                <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs mr-2">
                  {{ tag }}
                </span>
              {% endfor %}
            </div>
            <button class="mt-3 text-blue-600 hover:text-blue-800 read-more-btn" data-id="{{ article.id }}">
              Read More <i class="fas fa-chevron-down"></i>
            </button>
            <div class="full-content hidden mt-3" id="content-{{ article.id }}">
              {% autoescape false %}{{ article.description }}{% endautoescape %}
            </div>
          </div>
        </div>
      {% else %}
        <p class="text-center text-gray-600">No newsletters found.</p>
      {% endfor %}
    </div>

    <!-- Newsletter Grid (Hidden by default) -->
    <div id="newslettersGrid" class="newsletters-grid hidden">
      {% for article in records %}
        <div class="bg-white shadow-md rounded-lg overflow-hidden">
          {% if article.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ article.image) }}"
                 class="w-full h-48 object-cover" alt="{{ article.title }}">
          {% endif %}
          <div class="p-4">
            <h2 class="text-xl font-semibold text-gray-800">{{ article.title }}</h2>
            <p class="text-sm text-gray-500 mb-2">
              {{ article.uploaded_at.strftime('%d %B %Y') }}
            </p>
            <div class="prose max-w-none text-gray-800 mb-3">
              {% autoescape false %}{{ article.description|truncate(150) }}{% endautoescape %}
            </div>
            <div class="mt-2">
              {% for tag in article.tags %}
                <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs mr-2">
                  {{ tag }}
                </span>
              {% endfor %}
            </div>
            <button class="mt-3 text-blue-600 hover:text-blue-800 read-more-btn" data-id="{{ article.id }}">
              Read More <i class="fas fa-chevron-down"></i>
            </button>
            <div class="full-content hidden mt-3" id="content-{{ article.id }}">
              {% autoescape false %}{{ article.description }}{% endautoescape %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Subscribe Form -->
    <div class="max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-md">
      <h3 class="text-xl font-semibold text-center mb-4">Subscribe to our Newsletter</h3>
      <form action="{{ url_for('subscribe_newsletter') }}" method="POST" class="flex">
        <input type="email" name="email" required placeholder="Enter your email"
               class="flex-1 px-4 py-2 border border-gray-300 rounded-l focus:outline-none">
        <button type="submit"
                class="bg-blue-600 text-white px-6 py-2 rounded-r hover:bg-blue-700">
          Subscribe
        </button>
      </form>
    </div>
  </div>

  <script>
    // View toggle functionality
    document.getElementById('listViewBtn').addEventListener('click', function() {
      document.getElementById('newslettersList').classList.remove('hidden');
      document.getElementById('newslettersGrid').classList.add('hidden');
      this.classList.add('active');
      document.getElementById('gridViewBtn').classList.remove('active');
    });
    
    document.getElementById('gridViewBtn').addEventListener('click', function() {
      document.getElementById('newslettersList').classList.add('hidden');
      document.getElementById('newslettersGrid').classList.remove('hidden');
      this.classList.add('active');
      document.getElementById('listViewBtn').classList.remove('active');
    });
    
    // Read more functionality
    document.querySelectorAll('.read-more-btn').forEach(button => {
      button.addEventListener('click', function() {
        const contentId = this.getAttribute('data-id');
        const content = document.getElementById(`content-${contentId}`);
        const icon = this.querySelector('i');
        
        if (content.classList.contains('hidden')) {
          content.classList.remove('hidden');
          icon.classList.remove('fa-chevron-down');
          icon.classList.add('fa-chevron-up');
          this.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
          content.classList.add('hidden');
          icon.classList.remove('fa-chevron-up');
          icon.classList.add('fa-chevron-down');
        }
      });
    });
  </script>
</body>
</html>